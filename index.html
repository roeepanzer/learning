<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Plant Monitor – Hello</title>
</head>
<body>
  <h1>Firebase Connection Test</h1>
  <div id="status">Connecting...</div>

<!--   <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    const ctx = document.getElementById('tempChart');
    new Chart(ctx, {
      type: 'line',
      data: {
        labels: ['t0','t1','t2','t3','t4'],
        datasets: [{ label: 'Temp °C', data: [24.1, 24.3, 24.7, 24.5, 24.9] }]
      }
    });
  </script> -->
  <script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js";
  import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAVMPlPrVKRvZ6VPdyXHlmxEQjmL1tmges",
    authDomain: "learning-d6e02.firebaseapp.com",
    databaseURL: "https://learning-d6e02-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "learning-d6e02",
    storageBucket: "learning-d6e02.firebasestorage.app",
    messagingSenderId: "119584364745",
    appId: "1:119584364745:web:62fe63a64dddbc8c329518",
    measurementId: "G-85VLDXL87W"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  // const timestampRef = ref(db, 'sensors/esp32_1/timestamp');
  // onValue(tempRef, (snapshot) => {
  //   document.body.innerHTML = "Timestamp: " + snapshot.val();

    async function testConnection() {
      try {
        // Write test value
        await set(ref(db, 'test/connection'), { status: "ok", time: Date.now() });

        // Read it back
        const snapshot = await get(ref(db, 'test/connection'));
        if (snapshot.exists()) {
          document.getElementById("status").innerText =
            "Connected! Value in DB: " + JSON.stringify(snapshot.val());
        } else {
          document.getElementById("status").innerText = "No data found.";
        }
      } catch (err) {
        document.getElementById("status").innerText = "Error: " + err;
      }
    }

    testConnection();
  });
</script>
</body>

</html>
