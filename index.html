<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Grow tracker</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font-family: system-ui, Arial, sans-serif; max-width: auto; margin: 2rem auto; line-height: 1.4; }
    pre { background: #f6f8fa; padding: 1rem; overflow: auto; }
    .dataCircles {}
    #lightView {}
    
    /* Layout */
    .gauges{
      display:flex;
      flex-wrap:wrap;
      justify-content:center;
      align-items:flex-start;
      gap:clamp(16px,4vw,40px);
      padding:clamp(10px,3vw,24px);
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    }
    
    /* One gauge */
    .gauge{
      text-align:center;
      --ring: rgba(0,0,0,0.85);
    }
    
    /* Titles above the circles */
    .gauge__title{
      font-weight:700;
      letter-spacing:.5px;
      margin-bottom:8px;
      font-size:clamp(18px,2.8vw,28px);
    }
    
    /* The circle */
    .gauge__dial{
      position:relative;
      width:clamp(160px,26vw,240px);
      aspect-ratio:1/1;
      border-radius:50%;
      border:4px solid var(--ring);
      background:var(--bg, #eee);
      display:grid;
      place-items:center;
      box-shadow: inset 0 1px 0 rgba(0,0,0,0.25);
    }
    
    /* Slightly “hand-drawn” outer ring */
    .gauge__dial::after{
      content:"";
      position:absolute;
      inset:-6px;
      border-radius:50%;
      border:3px solid var(--ring);
      transform:rotate(-5deg) scale(1.018);
      pointer-events:none;
    }
    
    /* Big number in the middle */
    .gauge__value{
      font-weight:800;
      line-height:1;
      font-size:clamp(38px,6vw,64px);
    }
    
    /* Unit at the bottom of the circle */
    .gauge__unit{
      position:absolute;
      bottom:16px;
      left:50%;
      transform:translateX(-50%);
      font-weight:700;
      font-size:clamp(14px,2.2vw,20px);
    }
    
    /* Colors per gauge (matched to your mockup) */
    .gauge[data-type="light"]  { --bg:#FBE79A; }  /* pastel yellow */
    .gauge[data-type="temp"]   { --bg:#BFE1FF; }  /* pastel blue   */
    .gauge[data-type="hum"]    { --bg:#BFEBC5; }  /* pastel green  */
    
    /* Optional: a little breathing room on small screens */
    @media (max-width:520px){
      .gauge__title{ margin-bottom:6px; }
      .gauge__unit{ bottom:14px; }
      .gauges{ flex-wrap:nowrap; /* force single row */}
    }
  </style>
</head>
<body>
  <h1>Firebase Realtime Database — Diagnostic</h1>
<!--   <a href="https://roeepanzer.github.io/learning/clock.html">link to my live clock</a> -->
  <div id="clock">Loading...</div>
    <script>
      function updateClock() {
        const now = new Date();
  
        // Format HH:MM:SS
        const hours = String(now.getHours()).padStart(2, '0');
        const minutes = String(now.getMinutes()).padStart(2, '0');
        const seconds = String(now.getSeconds()).padStart(2, '0');
  
        // Format DD.MM.YYYY
        const day = String(now.getDate()).padStart(2, '0');
        const month = String(now.getMonth() + 1).padStart(2, '0'); // Months are 0-based
        const year = now.getFullYear();
  
        const timeString = `${hours}:${minutes}:${seconds}`;
        const dateString = `${day}.${month}.${year}`;
  
        document.getElementById('clock').textContent = `${timeString}  ${dateString}`;
      }
      // Update immediately, then every second
      updateClock();
      setInterval(updateClock, 1000);
    </script>
  
  <div class="gauges">
    <section class="gauge" data-type="light">
      <div class="gauge__title">Light</div>
      <div class="gauge__dial">
        <div class="gauge__value" id="lightView">NoLight</div>
        <div class="gauge__unit">lux</div>
      </div>
    </section>
  
    <section class="gauge" data-type="temp">
      <div class="gauge__title">Temperature</div>
      <div class="gauge__dial">
        <div class="gauge__value" id="tempView">NoTemp</div>
        <div class="gauge__unit">&deg;C</div>
      </div>
    </section>
  
    <section class="gauge" data-type="hum">
      <div class="gauge__title">humidity</div>
      <div class="gauge__dial">
        <div class="gauge__value" id="humidView">noHumid</div>
        <div class="gauge__unit">%</div>
      </div>
    </section>
  </div>
<!--   <h3>Logs</h3> -->
<!--   <pre id="log"></pre> -->

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
    import { getDatabase, ref, set, get, onValue } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-database.js";
    
    // const log = (...args) => {console.log(...args); document.getElementById('log').textContent += args.join(' ') + '\n'; };
    const lightEl = document.getElementById('lightView');
    const tempEl = document.getElementById('tempView');
    const humidEl = document.getElementById('humidView');

    const firebaseConfig = {
      apiKey: "AIzaSyAVMPlPrVKRvZ6VPdyXHlmxEQjmL1tmges",
      authDomain: "learning-d6e02.firebaseapp.com",
      databaseURL: "https://learning-d6e02-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "learning-d6e02",
      storageBucket: "learning-d6e02.firebasestorage.app",
      messagingSenderId: "119584364745",
      appId: "1:119584364745:web:62fe63a64dddbc8c329518",
      measurementId: "G-85VLDXL87W"
    };
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    async function liveHumid() {
      onValue(ref(db, 'liveData/humid'), (snapshot) => {
        if(snapshot.exists()) {
          const value = snapshot.val();
          humidEl.textContent = value;
        }
      });
    }

    async function liveTemp() {
      onValue(ref(db, 'liveData/temp'), (snapshot) => {
        if(snapshot.exists()) {
          const value = snapshot.val();
          tempEl.textContent = value;
        }
      });
    }

    async function liveLight() {
      onValue(ref(db, 'liveData/light'), (snapshot) => {
        if(snapshot.exists()) {
          const value = snapshot.val();
          lightEl.textContent = value;
        }
      });
    }
    
    async function onValueLiveGeneralData() {
      onValue(ref(db, 'test'), (snapshot) => {
        if(snapshot.exists()) {
          const value = snapshot.val();
          log("---------");
          log("General value is: " + value);
          log("int value is: " + value.int);
          log("float value is: " + value.float);
          log("---------");
          GeneralEl.textContent = value;
        }
      });
    }
    
    async function testConn() {
      statusEl.textContent = 'Writing test value…';
      set(ref(db, 'test/connection'), {status: "ok", timeStamp: Date.now() });
      log('Write succeeded');
    };
  
    liveLight();
    liveTemp();
    liveHumid();
  </script>
</body>
</html>
